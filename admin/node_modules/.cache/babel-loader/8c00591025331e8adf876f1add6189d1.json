{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { gridColumnLookupSelector, useGridApiEventHandler, useGridApiMethod } from '@mui/x-data-grid-pro';\nimport { gridAggregationModelSelector } from './gridAggregationSelectors';\nimport { getAggregationRules, mergeStateWithAggregationModel, areAggregationRulesEqual } from './gridAggregationUtils';\nimport { createAggregationLookup } from './createAggregationLookup';\nexport const aggregationStateInitializer = (state, props, apiRef) => {\n  var _ref, _props$aggregationMod, _props$initialState, _props$initialState$a;\n  apiRef.current.caches.aggregation = {\n    rulesOnLastColumnHydration: {},\n    rulesOnLastRowHydration: {}\n  };\n  return _extends({}, state, {\n    aggregation: {\n      model: (_ref = (_props$aggregationMod = props.aggregationModel) != null ? _props$aggregationMod : (_props$initialState = props.initialState) == null ? void 0 : (_props$initialState$a = _props$initialState.aggregation) == null ? void 0 : _props$initialState$a.model) != null ? _ref : {}\n    }\n  });\n};\nexport const useGridAggregation = (apiRef, props) => {\n  apiRef.current.registerControlState({\n    stateId: 'aggregation',\n    propModel: props.aggregationModel,\n    propOnChange: props.onAggregationModelChange,\n    stateSelector: gridAggregationModelSelector,\n    changeEvent: 'aggregationModelChange'\n  });\n\n  /**\n   * API METHODS\n   */\n  const setAggregationModel = React.useCallback(model => {\n    const currentModel = gridAggregationModelSelector(apiRef);\n    if (currentModel !== model) {\n      apiRef.current.setState(mergeStateWithAggregationModel(model));\n      apiRef.current.forceUpdate();\n    }\n  }, [apiRef]);\n  const applyAggregation = React.useCallback(() => {\n    const aggregationLookup = createAggregationLookup({\n      apiRef,\n      getAggregationPosition: props.getAggregationPosition,\n      aggregationFunctions: props.aggregationFunctions,\n      aggregationRowsScope: props.aggregationRowsScope\n    });\n    apiRef.current.setState(state => _extends({}, state, {\n      aggregation: _extends({}, state.aggregation, {\n        lookup: aggregationLookup\n      })\n    }));\n  }, [apiRef, props.getAggregationPosition, props.aggregationFunctions, props.aggregationRowsScope]);\n  const aggregationApi = {\n    setAggregationModel\n  };\n  useGridApiMethod(apiRef, aggregationApi, 'public');\n\n  /**\n   * EVENTS\n   */\n  const checkAggregationRulesDiff = React.useCallback(() => {\n    const {\n      rulesOnLastRowHydration,\n      rulesOnLastColumnHydration\n    } = apiRef.current.caches.aggregation;\n    const aggregationRules = props.disableAggregation ? {} : getAggregationRules({\n      columnsLookup: gridColumnLookupSelector(apiRef),\n      aggregationModel: gridAggregationModelSelector(apiRef),\n      aggregationFunctions: props.aggregationFunctions\n    });\n\n    // Re-apply the row hydration to add / remove the aggregation footers\n    if (!areAggregationRulesEqual(rulesOnLastRowHydration, aggregationRules)) {\n      apiRef.current.requestPipeProcessorsApplication('hydrateRows');\n      applyAggregation();\n    }\n\n    // Re-apply the column hydration to wrap / unwrap the aggregated columns\n    if (!areAggregationRulesEqual(rulesOnLastColumnHydration, aggregationRules)) {\n      apiRef.current.caches.aggregation.rulesOnLastColumnHydration = aggregationRules;\n      apiRef.current.requestPipeProcessorsApplication('hydrateColumns');\n    }\n  }, [apiRef, applyAggregation, props.aggregationFunctions, props.disableAggregation]);\n  useGridApiEventHandler(apiRef, 'aggregationModelChange', checkAggregationRulesDiff);\n  useGridApiEventHandler(apiRef, 'columnsChange', checkAggregationRulesDiff);\n  useGridApiEventHandler(apiRef, 'filteredRowsSet', applyAggregation);\n\n  /**\n   * EFFECTS\n   */\n  React.useEffect(() => {\n    if (props.aggregationModel !== undefined) {\n      apiRef.current.setAggregationModel(props.aggregationModel);\n    }\n  }, [apiRef, props.aggregationModel]);\n};","map":{"version":3,"names":["_extends","React","gridColumnLookupSelector","useGridApiEventHandler","useGridApiMethod","gridAggregationModelSelector","getAggregationRules","mergeStateWithAggregationModel","areAggregationRulesEqual","createAggregationLookup","aggregationStateInitializer","state","props","apiRef","_ref","_props$aggregationMod","_props$initialState","_props$initialState$a","current","caches","aggregation","rulesOnLastColumnHydration","rulesOnLastRowHydration","model","aggregationModel","initialState","useGridAggregation","registerControlState","stateId","propModel","propOnChange","onAggregationModelChange","stateSelector","changeEvent","setAggregationModel","useCallback","currentModel","setState","forceUpdate","applyAggregation","aggregationLookup","getAggregationPosition","aggregationFunctions","aggregationRowsScope","lookup","aggregationApi","checkAggregationRulesDiff","aggregationRules","disableAggregation","columnsLookup","requestPipeProcessorsApplication","useEffect","undefined"],"sources":["D:/Tanot/admin/node_modules/@mui/x-data-grid-generator/node_modules/@mui/x-data-grid-premium/hooks/features/aggregation/useGridAggregation.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { gridColumnLookupSelector, useGridApiEventHandler, useGridApiMethod } from '@mui/x-data-grid-pro';\nimport { gridAggregationModelSelector } from './gridAggregationSelectors';\nimport { getAggregationRules, mergeStateWithAggregationModel, areAggregationRulesEqual } from './gridAggregationUtils';\nimport { createAggregationLookup } from './createAggregationLookup';\nexport const aggregationStateInitializer = (state, props, apiRef) => {\n  var _ref, _props$aggregationMod, _props$initialState, _props$initialState$a;\n  apiRef.current.caches.aggregation = {\n    rulesOnLastColumnHydration: {},\n    rulesOnLastRowHydration: {}\n  };\n  return _extends({}, state, {\n    aggregation: {\n      model: (_ref = (_props$aggregationMod = props.aggregationModel) != null ? _props$aggregationMod : (_props$initialState = props.initialState) == null ? void 0 : (_props$initialState$a = _props$initialState.aggregation) == null ? void 0 : _props$initialState$a.model) != null ? _ref : {}\n    }\n  });\n};\nexport const useGridAggregation = (apiRef, props) => {\n  apiRef.current.registerControlState({\n    stateId: 'aggregation',\n    propModel: props.aggregationModel,\n    propOnChange: props.onAggregationModelChange,\n    stateSelector: gridAggregationModelSelector,\n    changeEvent: 'aggregationModelChange'\n  });\n\n  /**\n   * API METHODS\n   */\n  const setAggregationModel = React.useCallback(model => {\n    const currentModel = gridAggregationModelSelector(apiRef);\n    if (currentModel !== model) {\n      apiRef.current.setState(mergeStateWithAggregationModel(model));\n      apiRef.current.forceUpdate();\n    }\n  }, [apiRef]);\n  const applyAggregation = React.useCallback(() => {\n    const aggregationLookup = createAggregationLookup({\n      apiRef,\n      getAggregationPosition: props.getAggregationPosition,\n      aggregationFunctions: props.aggregationFunctions,\n      aggregationRowsScope: props.aggregationRowsScope\n    });\n    apiRef.current.setState(state => _extends({}, state, {\n      aggregation: _extends({}, state.aggregation, {\n        lookup: aggregationLookup\n      })\n    }));\n  }, [apiRef, props.getAggregationPosition, props.aggregationFunctions, props.aggregationRowsScope]);\n  const aggregationApi = {\n    setAggregationModel\n  };\n  useGridApiMethod(apiRef, aggregationApi, 'public');\n\n  /**\n   * EVENTS\n   */\n  const checkAggregationRulesDiff = React.useCallback(() => {\n    const {\n      rulesOnLastRowHydration,\n      rulesOnLastColumnHydration\n    } = apiRef.current.caches.aggregation;\n    const aggregationRules = props.disableAggregation ? {} : getAggregationRules({\n      columnsLookup: gridColumnLookupSelector(apiRef),\n      aggregationModel: gridAggregationModelSelector(apiRef),\n      aggregationFunctions: props.aggregationFunctions\n    });\n\n    // Re-apply the row hydration to add / remove the aggregation footers\n    if (!areAggregationRulesEqual(rulesOnLastRowHydration, aggregationRules)) {\n      apiRef.current.requestPipeProcessorsApplication('hydrateRows');\n      applyAggregation();\n    }\n\n    // Re-apply the column hydration to wrap / unwrap the aggregated columns\n    if (!areAggregationRulesEqual(rulesOnLastColumnHydration, aggregationRules)) {\n      apiRef.current.caches.aggregation.rulesOnLastColumnHydration = aggregationRules;\n      apiRef.current.requestPipeProcessorsApplication('hydrateColumns');\n    }\n  }, [apiRef, applyAggregation, props.aggregationFunctions, props.disableAggregation]);\n  useGridApiEventHandler(apiRef, 'aggregationModelChange', checkAggregationRulesDiff);\n  useGridApiEventHandler(apiRef, 'columnsChange', checkAggregationRulesDiff);\n  useGridApiEventHandler(apiRef, 'filteredRowsSet', applyAggregation);\n\n  /**\n   * EFFECTS\n   */\n  React.useEffect(() => {\n    if (props.aggregationModel !== undefined) {\n      apiRef.current.setAggregationModel(props.aggregationModel);\n    }\n  }, [apiRef, props.aggregationModel]);\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}